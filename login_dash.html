<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>ERP √çMPAR ¬∑ Login ‚Äì Dashboard de Custos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg-degrade-start: #020617;
      --bg-degrade-mid: #0f172a;
      --bg-degrade-end: #f97316;
      --card-bg: rgba(15,23,42,0.98);
      --card-border: rgba(148,163,184,0.6);
      --text-main: #e5e7eb;
      --text-soft: #9ca3af;
      --accent: #22c55e;
      --danger: #ef4444;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Candara, "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background:
        radial-gradient(circle at 0 0, #1d4ed8 0, transparent 55%),
        radial-gradient(circle at 100% 100%, #f97316 0, transparent 55%),
        linear-gradient(135deg, var(--bg-degrade-start), var(--bg-degrade-mid) 55%, var(--bg-degrade-end));
      color: var(--text-main);
    }

    .header-bar {
      position: absolute;
      top: 16px;
      left: 16px;
      right: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 960px;
      margin: 0 auto;
      inset-inline: 0;
    }

    .header-left {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .header-tag {
      font-size: 11px;
      letter-spacing: .22em;
      text-transform: uppercase;
      color: #cbd5e1;
    }

    .header-title {
      font-size: 22px;
      font-weight: 800;
      color: #f9fafb;
    }

    .header-subtitle {
      font-size: 12px;
      color: #cbd5e1;
    }

    .menu-btn {
      border-radius: 999px;
      border: 1px solid rgba(148,163,184,.6);
      background: rgba(15,23,42,.95);
      color: #e5e7eb;
      padding: 8px 18px;
      font-size: 13px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      box-shadow: 0 10px 24px rgba(15,23,42,.7);
      transition: transform .12s ease, box-shadow .2s ease, background .2s ease;
    }

    .menu-btn span.icn { font-size: 15px; }
    .menu-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(15,23,42,.8);
      background: linear-gradient(135deg, #1d4ed8, #2563eb);
    }

    .login-wrapper {
      width: 100%;
      max-width: 960px;
      margin: 80px auto 24px;
      padding: 0 16px;
      display: flex;
      justify-content: center;
    }

    .login-card {
      width: 100%;
      max-width: 420px;
      background: var(--card-bg);
      border-radius: 24px;
      border: 1px solid var(--card-border);
      box-shadow: 0 24px 70px rgba(15,23,42,0.8);
      padding: 26px 26px 22px;
    }

    .login-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .login-subtitle {
      font-size: 12px;
      color: var(--text-soft);
      margin-bottom: 18px;
    }

    .form-group {
      margin-bottom: 14px;
    }

    .form-group label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #cbd5e1;
      display: block;
      margin-bottom: 4px;
    }

    select,
    input[type="password"] {
      width: 100%;
      border-radius: 999px;
      border: 1px solid #4b5563;
      padding: 8px 14px;
      font-size: 13px;
      outline: none;
      color: #111827;
    }

    select:focus,
    input[type="password"]:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 2px rgba(37,99,235,0.4);
    }

    .password-wrapper {
      position: relative;
    }

    .toggle-password {
      position: absolute;
      right: 14px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 14px;
      color: #6b7280;
    }

    .remember-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 14px;
      font-size: 12px;
      color: var(--text-soft);
    }

    .remember-row input {
      margin: 0;
    }

    .login-btn {
      width: 100%;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #022c22;
      font-weight: 700;
      font-size: 14px;
      padding: 9px 0;
      cursor: pointer;
      box-shadow: 0 14px 30px rgba(34,197,94,0.5);
      transition: transform .12s ease, box-shadow .2s ease, filter .2s ease;
    }

    .login-btn:hover {
      transform: translateY(-1px);
      filter: brightness(1.02);
      box-shadow: 0 18px 40px rgba(34,197,94,0.65);
    }

    .error-msg {
      font-size: 12px;
      color: var(--danger);
      min-height: 16px;
      margin-bottom: 4px;
    }

    .login-footer {
      font-size: 11px;
      color: #9ca3af;
      text-align: center;
      margin-top: 10px;
    }

    @media (max-width: 640px) {
      .header-bar {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      .login-wrapper { margin-top: 96px; }
    }
  </style>
</head>
<body>
  <header class="header-bar">
    <div class="header-left">
      <span class="header-tag">PLATAFORMA</span>
      <h1 class="header-title">ERP √çMPAR ‚Ä¢ Dashboard de Custos</h1>
      <span class="header-subtitle">Acesso ao dashboard de m√£o de obra e despesas vari√°veis</span>
    </div>
    <button class="menu-btn" type="button" onclick="window.location.href='index.html'">
      <span class="icn">üè†</span>
      <span>Menu principal</span>
    </button>
  </header>

  <main class="login-wrapper">
    <section class="login-card">
      <h2 class="login-title">Login ‚Äì Dashboard de Custos</h2>
      <p class="login-subtitle">
        Selecione seu usu√°rio corporativo, informe a senha e acesse os pain√©is
        de custos de m√£o de obra e despesas vari√°veis.
      </p>

      <div class="form-group">
        <label for="usuario-select">Usu√°rio</label>
        <select id="usuario-select">
          <option value="">Selecione seu usu√°rio...</option>
        </select>
      </div>

      <div class="form-group">
        <label for="senha-input">Senha</label>
        <div class="password-wrapper">
          <input type="password" id="senha-input" placeholder="Digite sua senha" />
          <span id="toggle-password" class="toggle-password">üëÅ</span>
        </div>
      </div>

      <div class="remember-row">
        <input type="checkbox" id="lembrar" />
        <label for="lembrar">Lembrar meu usu√°rio neste computador</label>
      </div>

      <div id="erro" class="error-msg"></div>

      <button class="login-btn" type="button" onclick="fazerLogin()">ENTRAR</button>

      <div class="login-footer">
        ¬© 2025 ERP √çMPAR ¬∑ Acesso ao Dashboard de Custos
      </div>
    </section>
  </main>

  <script>
    const USUARIOS_JSON = "usuarios_dash.json";
    const DASH_URL      = "dashboard_custos.html";

    let usuarios = [];

    async function carregarUsuarios() {
      try {
        const resp = await fetch(USUARIOS_JSON + "?v=" + Date.now());
        usuarios = await resp.json();
        const select = document.getElementById("usuario-select");

        usuarios.forEach(u => {
          const opt = document.createElement("option");
          opt.value = u.id;
          opt.textContent = u.nome;
          select.appendChild(opt);
        });

        const lembrado = localStorage.getItem("dash_usuario_id");
        if (lembrado) {
          select.value = lembrado;
        }
      } catch (e) {
        console.error(e);
        document.getElementById("erro").textContent =
          "Erro ao carregar lista de usu√°rios.";
      }
    }

    function fazerLogin() {
      const select = document.getElementById("usuario-select");
      const senhaInput = document.getElementById("senha-input");
      const erroEl = document.getElementById("erro");
      erroEl.textContent = "";

      const id = select.value;
      const senha = senhaInput.value.trim();

      if (!id) {
        erroEl.textContent = "Selecione um usu√°rio.";
        return;
      }
      if (!senha) {
        erroEl.textContent = "Informe a senha.";
        return;
      }

      const usuario = usuarios.find(u => u.id === id);
      if (!usuario || usuario.senha !== senha) {
        erroEl.textContent = "Usu√°rio ou senha inv√°lidos.";
        return;
      }

      if (document.getElementById("lembrar").checked) {
        localStorage.setItem("dash_usuario_id", usuario.id);
      } else {
        localStorage.removeItem("dash_usuario_id");
      }

      localStorage.setItem("dash_usuario_nome", usuario.nome);
      window.location.href = DASH_URL;
    }

    document.getElementById("toggle-password").addEventListener("click", () => {
      const input = document.getElementById("senha-input");
      input.type = input.type === "password" ? "text" : "password";
    });

    document.addEventListener("DOMContentLoaded", carregarUsuarios);
  </script>
</body>
</html>
