<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ERP √çMPAR ‚Äî Consulta de Pre√ßos</title>
  <style>
:root{
      --bg:#020617;
      --card:#020617;
      --border:#1f2937;
      --text:#e5e7eb;
      --text-soft:#9ca3af;
      --blue:#3b82f6;
      --blue-dark:#1d4ed8;
      --green:#22c55e;
      --yellow:#eab308;
      --red:#ef4444;
      --accent:#cc6e00;
    }
    *{box-sizing:border-box;margin:0;padding:0}

    body{
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      background:linear-gradient(120deg,#0b1e4a,#0e3b6e,#0f766e);
      color:var(--text);
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }

    header{
      padding:10px 16px 4px;
      display:flex;
      justify-content:center;
    }
    .header-inner{
      width:100%;
      max-width:1200px;
      display:flex;
      justify-content:space-between;
      gap:16px;
      align-items:flex-start;
    }
    .brand{
      display:flex;
      flex-direction:row;
      align-items:center;
      gap:12px;
      text-shadow:0 2px 6px rgba(0,0,0,.8);
    }
    .brand-txt{display:flex; flex-direction:column; gap:2px;}
    .brand-kicker{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:.85;
    }
    .brand-title{
      font-size:16px;
      font-weight:800;
      letter-spacing:.02em;
    }
    .brand-sub{
      font-size:12px;
      opacity:.85;
    }
    .tag-top{
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      background:rgba(15,23,42,.9);
      border:1px solid rgba(148,163,184,.7);
      color:var(--text-soft);
      display:flex;
      gap:8px;
      align-items:center;
      margin-top:12px;
    }
    .pill-btn{
      border:none;
      background:transparent;
      color:inherit;
      font:inherit;
      display:flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
    }
    .pill-btn .icn{font-size:14px;}

    main{
      flex:1;
      display:flex;
      justify-content:center;
      padding:12px 16px 18px;
    }
    .layout{
      width:100%;
      max-width:1200px;
      display:flex;
      justify-content:center;
    }
    .container{
      width:100%;
      background:linear-gradient(120deg,#0b1e4a,#0e3b6e,#0f766e);
      border-radius:18px;
      border:1px solid rgba(148,163,184,.6);
      box-shadow:0 24px 60px rgba(15,23,42,.9);
      padding:18px 18px 16px;
    }

    h1{
      font-size:18px;
      margin-bottom:4px;
    }
    .subtitulo{
      font-size:12px;
      color:var(--text-soft);
      margin-bottom:10px;
    }

    form{
      margin-top:4px;
      font-size:12px;
    }
    label{
      display:block;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#9ca3af;
      margin-bottom:4px;
    }
    input,select{
      width:100%;
      padding:6px 8px;
      border-radius:8px;
      border:1px solid #111827;
      background:#020617;
      color:var(--text);
      font-size:12px;
      outline:none;
    }
    input:focus,select:focus{
      border-color:var(--blue);
      box-shadow:0 0 0 1px rgba(59,130,246,.95), 0 0 18px rgba(59,130,246,.55), 0 0 46px rgba(29,78,216,.35);
    }
    input[disabled]{
      opacity:.85;
      cursor:not-allowed;
    }

    .form-row{
      display:flex;
      gap:12px;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .form-row>div{
      flex:1 1 0;
      min-width:160px;
    }

    .modo-manual-box{
      margin-top:4px;
      font-size:11px;
      color:var(--text-soft);
    }
    .modo-manual-box label{
      text-transform:none;
      letter-spacing:0;
      display:flex;
      align-items:center;
      gap:6px;
      margin:0;
      cursor:pointer;
    }
    .modo-manual-box input[type="checkbox"]{
      width:auto;
      accent-color:var(--blue);
    }

    .btn-primary,
    .btn-secondary{
      border:none;
      border-radius:999px;
      padding:7px 14px;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.12em;
      font-weight:600;
      cursor:pointer;
    }
    .btn-primary{
      background:linear-gradient(135deg,#22c55e,#16a34a);
      color:#020617;
      box-shadow:0 10px 30px rgba(22,163,74,.6);
    }
    .btn-secondary{
      background:#111827;
      color:#fff;
      border:1px solid #374151;
    }

    .actions{
      margin-top:8px;
      margin-bottom:4px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }

    .header-info{
      margin-top:2px;
      margin-bottom:6px;
      font-size:12px;
      color:#cfd8ff;
    }
    .header-info strong{font-weight:600;}

    .table-wrapper{
      overflow-x:auto;
      border-radius:12px;
      border:1px solid #111827;
      margin-top:6px;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
      background:#020617;
      min-width:480px;
    }
    th,td{
      padding:5px 6px;
      border-bottom:1px solid #1f2937;
      text-align:left;
    }
    th{
      background:#020617;
      position:sticky;
      top:0;
      z-index:1;
      font-weight:600;
      color:var(--text-soft);
    }
    tbody tr:hover{
      background:#111827;
    }
    .btn-remover{
      cursor:pointer;
    }

    footer{
      background:#020617;
      color:#9ca3af;
      padding:6px 16px;
      font-size:10px;
    }
    .rodape-inner{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    @media(max-width:900px){
      .container{padding:14px 12px 16px;}
      h1{font-size:16px;}
    }
  
/* =========================================================
   √çMPAR PREMIUM (Menu) ‚Äî Overrides Visuais
   *N√£o mexe em IDs, nomes e l√≥gica do JS*
   ========================================================= */

:root{
  --p-bg-left:  #0b3a8a;
  --p-bg-mid:   #0b4c7a;
  --p-bg-right: #0a8a71;

  --p-card: rgba(2, 6, 23, .58);
  --p-card-2: rgba(2, 6, 23, .70);
  --p-border: rgba(255,255,255,.10);
  --p-border-soft: rgba(255,255,255,.08);

  --p-text: #e5e7eb;
  --p-text-soft: rgba(229,231,235,.78);

  --p-blue: #2f7bff;
  --p-blue-soft: rgba(47,123,255,.35);
  --p-green: #22c55e;

  --p-grad: linear-gradient(90deg, rgba(37,99,235,1), rgba(16,185,129,1));
  --p-grad-soft: linear-gradient(90deg, rgba(37,99,235,.25), rgba(16,185,129,.20));

  --p-radius: 22px;
  --p-radius-sm: 14px;
}

/* Fundo igual Menu */
body{
  color: var(--p-text) !important;
  background:linear-gradient(120deg,#0b1e4a,#0e3b6e,#0f766e);
      }
body{
  min-height:100vh;
  display:flex;
  flex-direction:column;
}
.layout{
  flex:1 0 auto;
  width:100%;
}
footer{
  margin-top:auto;
}

/* Evita scroll horizontal em tabelas sem "empurrar" a p√°gina */
.tabela-wrapper{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}
.tabela-wrapper table{
  min-width: 760px; /* garante scroll dentro do wrapper, n√£o no body */
}

/* Loader sempre centralizado */
/* Mobile (<= 720px) */
@media (max-width: 720px){
  header{
    padding: 14px 12px;
  }
  .header-inner{
    flex-wrap: wrap;
    gap: 10px;
  }
  .brand{
    flex: 1 1 auto;
    min-width: 0;
  }
  .brand-text{
    min-width:0;
  }
  .brand-line{
    white-space: normal;
    line-height: 1.15;
  }
  .brand-title{
    font-size: 18px;
  }
  .brand-sub{
    font-size: 12px;
  }
  .title-stack{
    flex: 1 1 100%;
    min-width: 0;
    text-align: left;
  }
  .page-title{
    font-size: 14px;
    white-space: normal;
    line-height: 1.15;
  }
  .sub-title{
    font-size: 12px;
    white-space: normal;
  }
  .actions{
    margin-left: auto;
  }

  .container{
    padding: 14px 12px 22px;
  }
  .card{
    padding: 16px;
    border-radius: 18px;
  }

  .form-row{
    gap: 10px;
  }
  .field{
    flex: 1 1 100%;
    min-width: 0;
  }

  .input,
  select,
  textarea{
    font-size: 14px;
  }

  /* √çcone do calend√°rio: menor e integrado, sem ‚Äúsobrar‚Äù */
  .date-icon-btn{
    width: 40px;
    right: 8px;
  }
  .field.has-icon input{
    padding-right: 52px !important;
  }

  /* Tabela: scroll dentro do card (sem quebrar layout) */
  .tabela-wrapper{
    margin-top: 10px;
    border-radius: 14px;
  }

  footer{
    padding: 12px 12px;
  }
}

/* Loader (igual menu) */
.loader-card{
  width:min(420px, 92vw);
  padding:18px 18px 16px;
  border-radius:18px;
  background: rgba(2,6,23,.66);
  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 30px 80px rgba(0,0,0,.45);
  backdrop-filter: blur(12px);
  text-align:center;
}
.loader-title{ font-weight:700; letter-spacing:.2px; margin:2px 0 6px; }
.loader-sub{ color: rgba(229,231,235,.78); font-size:12px; margin:0 0 10px; }
.spinner{
  width:44px; height:44px;
  border-radius:999px;
  border:4px solid rgba(255,255,255,.14);
  border-top-color: rgba(37,99,235,1);
  border-right-color: rgba(16,185,129,1);
  animation: spin 0.9s linear infinite;
  margin: 0 auto 8px;
}
@keyframes spin{ to{ transform: rotate(360deg);} }

/* Date input with calendar icon */
.date-wrap{ position:relative; }
.date-wrap input[type="date"]{ padding-right:42px !important; }
.date-icn{
  position:absolute; right:10px; top:50%;
  transform: translateY(-50%);
  width:30px; height:30px;
  border-radius:10px;
  display:grid; place-items:center;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  cursor:pointer;
  transition: transform .15s ease, background .15s ease, box-shadow .15s ease;
}
.date-icn:hover{
  transform: translateY(-50%) scale(1.03);
  background: rgba(255,255,255,.08);
  box-shadow: 0 12px 28px rgba(0,0,0,.22);
}
.date-icn svg{ width:16px; height:16px; opacity:.92; }



	'''      align-items:flex-start;
    }
    .brand{
      display:flex;
      flex-direction:row;
      align-items:center;
      gap:12px;
      text-shadow:0 2px 6px rgba(0,0,0,.8);
    }
    .brand-txt{display:flex; flex-direction:column; gap:2px;}
    .brand-kicker{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:.85;
    }
    .brand-title{
      font-size:16px;
      font-weight:800;
      letter-spacing:.02em;
    }
    .brand-sub{
      font-size:12px;
      opacity:.85;
    }
    .tag-top{
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      background:rgba(15,23,42,.9);
      border:1px solid rgba(148,163,184,.7);
      color:var(--text-soft);
      display:flex;
      gap:8px;
      align-items:center;
      margin-top:12px;
    }
    .pill-btn{
      border:none;
      background:transparent;
      color:inherit;
      font:inherit;
      display:flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
    }
    .pill-btn .icn{font-size:14px;}

    main{
      flex:1;
      display:flex;
      justify-content:center;
      padding:12px 16px 18px;
    }
    .layout{
      width:100%;
      max-width:1200px;
      display:flex;
      justify-content:center;
    }
    .container{
      width:100%;
      background:radial-gradient(circle at top left,rgba(59,130,246,.16) 0,transparent 55%),
                 radial-gradient(circle at bottom right,rgba(248,113,113,.14) 0,transparent 55%),
                 linear-gradient(135deg,rgba(15,23,42,.98),rgba(12,10,25,.98));
      border-radius:18px;
      border:1px solid rgba(148,163,184,.6);
      box-shadow:0 24px 60px rgba(15,23,42,.9);
      padding:18px 18px 16px;
    }

    h1{
      font-size:18px;
      margin-bottom:4px;
    }
    .subtitulo{
      font-size:12px;
      color:var(--text-soft);
      margin-bottom:10px;
    }

    form{
      margin-top:4px;
      font-size:12px;
    }
    label{
      display:block;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#9ca3af;
      margin-bottom:4px;
    }
    input,select{
      width:100%;
      padding:6px 8px;
      border-radius:8px;
      border:1px solid #111827;
      background:#020617;
      color:var(--text);
      font-size:12px;
      outline:none;
    }
    input:focus,select:focus{
      border-color:var(--blue);
      box-shadow:0 0 0 1px rgba(59,130,246,.6);
    }
    input[disabled]{
      opacity:.85;
      cursor:not-allowed;
    }

    .form-row{
      display:flex;
      gap:12px;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .form-row>div{
      flex:1 1 0;
      min-width:160px;
    }

    .modo-manual-box{
      margin-top:4px;
      font-size:11px;
      color:var(--text-soft);
    }
    .modo-manual-box label{
      text-transform:none;
      letter-spacing:0;
      display:flex;
      align-items:center;
      gap:6px;
      margin:0;
      cursor:pointer;
    }
    .modo-manual-box input[type="checkbox"]{
      width:auto;
      accent-color:var(--blue);
    }



/* --- √çMPAR Premium: logo orb no header --- */
.logo-orb{
      width:36px;height:36px;border-radius:999px;
      position:relative;
      background: conic-gradient(from 210deg,
        #22c55e,
        #06b6d4,
        #3b82f6,
        #a855f7,
        #f97316,
        #22c55e);
      box-shadow:
        0 10px 22px rgba(0,0,0,.35),
        0 0 0 1px rgba(255,255,255,.18) inset;
      overflow:hidden;
      flex:0 0 auto;
    }
    .logo-orb:before{
      content:"";
      position:absolute; inset:-6px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), transparent 55%);
      filter: blur(0.2px);
    }
    .logo-orb:after{
      content:"";
      position:absolute; inset:-14px;
      background: radial-gradient(circle at 50% 50%, rgba(34,197,94,.35), transparent 65%);
      filter: blur(10px);
      opacity:.7;
    }


    header{
      padding:10px 16px 4px;
      display:flex;
      justify-content:center;
    }
    .header-inner{
      width:100%;
      max-width:1200px;
      display:flex;
      justify-content:space-between;
      gap:16px;
      align-items:flex-start;
    }
    .brand{
      display:flex;
      flex-direction:row;
      align-items:center;
      gap:12px;
      text-shadow:0 2px 6px rgba(0,0,0,.8);
    }
    .brand-txt{display:flex; flex-direction:column; gap:2px;}
    .brand-kicker{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:.85;
    }
    .brand-title{
      font-size:16px;
      font-weight:800;
      letter-spacing:.02em;
    }
    .brand-sub{
      font-size:12px;
      opacity:.85;
    }
    .tag-top{
      font-size:11px;
      padding:4px 10px;
      border-radius:999px;
      background:rgba(15,23,42,.9);
      border:1px solid rgba(148,163,184,.7);
      color:var(--text-soft);
      display:flex;
      gap:8px;
      align-items:center;
      margin-top:12px;
    }
    .pill-btn{
      border:none;
      background:transparent;
      color:inherit;
      font:inherit;
      display:flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
    }
    .pill-btn .icn{font-size:14px;}

    main{
      flex:1;
      display:flex;
      justify-content:center;
      padding:12px 16px 18px;
    }
    .layout{
      width:100%;
      max-width:1200px;
      display:flex;
      justify-content:center;
    }
    .container{
      width:100%;
      background:linear-gradient(120deg,#0b1e4a,#0e3b6e,#0f766e);
      border-radius:18px;
      border:1px solid rgba(148,163,184,.6);
      box-shadow:0 24px 60px rgba(15,23,42,.9);
      padding:18px 18px 16px;
    }

    h1{
      font-size:18px;
      margin-bottom:4px;
    }
    .subtitulo{
      font-size:12px;
      color:var(--text-soft);
      margin-bottom:10px;
    }

    form{
      margin-top:4px;
      font-size:12px;
    }
    label{
      display:block;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#9ca3af;
      margin-bottom:4px;
    }
    input,select{
      width:100%;
      padding:6px 8px;
      border-radius:8px;
      border:1px solid #111827;
      background:#020617;
      color:var(--text);
      font-size:12px;
      outline:none;
    }
    input:focus,select:focus{
      border-color:var(--blue);
      box-shadow:0 0 0 1px rgba(59,130,246,.95), 0 0 18px rgba(59,130,246,.55), 0 0 46px rgba(29,78,216,.35);
    }
    input[disabled]{
      opacity:.85;
      cursor:not-allowed;
    }

    .form-row{
      display:flex;
      gap:12px;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .form-row>div{
      flex:1 1 0;
      min-width:160px;
    }

    .modo-manual-box{
      margin-top:4px;
      font-size:11px;
      color:var(--text-soft);
    }
    .modo-manual-box label{
      text-transform:none;
      letter-spacing:0;
      display:flex;
      align-items:center;
      gap:6px;
      margin:0;
      cursor:pointer;
    }
    .modo-manual-box input[type="checkbox"]{
      width:auto;
      accent-color:var(--blue);
    }

    .btn-primary,
    .btn-secondary{
      border:none;
      border-radius:999px;
      padding:7px 14px;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.12em;
      font-weight:600;
      cursor:pointer;
    }
    .btn-primary{
      background:linear-gradient(135deg,#22c55e,#16a34a);
      color:#020617;
      box-shadow:0 10px 30px rgba(22,163,74,.6);
    }
    .btn-secondary{
      background:#111827;
      color:#fff;
      border:1px solid #374151;
    }

    .actions{
      margin-top:8px;
      margin-bottom:4px;
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }

    .header-info{
      margin-top:2px;
      margin-bottom:6px;
      font-size:12px;
      color:#cfd8ff;
    }
    .header-info strong{font-weight:600;}

    .table-wrapper{
      overflow-x:auto;
      border-radius:12px;
      border:1px solid #111827;
      margin-top:6px;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
      background:#020617;
      min-width:480px;
    }
    th,td{
      padding:5px 6px;
      border-bottom:1px solid #1f2937;
      text-align:left;
    }
    th{
      background:#020617;
      position:sticky;
      top:0;
      z-index:1;
      font-weight:600;
      color:var(--text-soft);
    }
    tbody tr:hover{
      background:#111827;
    }
    .btn-remover{
      cursor:pointer;
    }

    footer{
      background:#020617;
      color:#9ca3af;
      padding:6px 16px;
      font-size:10px;
    }
    .rodape-inner{
      max-width:1200px;
      margin:0 auto;
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }

    @media(max-width:900px){
      .container{padding:14px 12px 16px;}
      h1{font-size:16px;}
    }
  
/* =========================================================
   √çMPAR PREMIUM (Menu) ‚Äî Overrides Visuais
   *N√£o mexe em IDs, nomes e l√≥gica do JS*
   ========================================================= */

:root{
  --p-bg-left:  #0b3a8a;
  --p-bg-mid:   #0b4c7a;
  --p-bg-right: #0a8a71;

  --p-card: rgba(2, 6, 23, .58);
  --p-card-2: rgba(2, 6, 23, .70);
  --p-border: rgba(255,255,255,.10);
  --p-border-soft: rgba(255,255,255,.08);

  --p-text: #e5e7eb;
  --p-text-soft: rgba(229,231,235,.78);

  --p-blue: #2f7bff;
  --p-blue-soft: rgba(47,123,255,.35);
  --p-green: #22c55e;

  --p-grad: linear-gradient(90deg, rgba(37,99,235,1), rgba(16,185,129,1));
  --p-grad-soft: linear-gradient(90deg, rgba(37,99,235,.25), rgba(16,185,129,.20));

  --p-radius: 22px;
  --p-radius-sm: 14px;
}

/* Fundo igual Menu */
body{
  color: var(--p-text) !important;
  background:linear-gradient(120deg,#0b1e4a,#0e3b6e,#0f766e);
      }
body{
  min-height:100vh;
  display:flex;
  flex-direction:column;
}
.layout{
  flex:1 0 auto;
  width:100%;
}
footer{
  margin-top:auto;
}

/* Evita scroll horizontal em tabelas sem "empurrar" a p√°gina */
.tabela-wrapper{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}
.tabela-wrapper table{
  min-width: 760px; /* garante scroll dentro do wrapper, n√£o no body */
}

/* Loader sempre centralizado */
/* Mobile (<= 720px) */
@media (max-width: 720px){
  header{
    padding: 14px 12px;
  }
  .header-inner{
    flex-wrap: wrap;
    gap: 10px;
  }
  .brand{
    flex: 1 1 auto;
    min-width: 0;
  }
  .brand-text{
    min-width:0;
  }
  .brand-line{
    white-space: normal;
    line-height: 1.15;
  }
  .brand-title{
    font-size: 18px;
  }
  .brand-sub{
    font-size: 12px;
  }
  .title-stack{
    flex: 1 1 100%;
    min-width: 0;
    text-align: left;
  }
  .page-title{
    font-size: 14px;
    white-space: normal;
    line-height: 1.15;
  }
  .sub-title{
    font-size: 12px;
    white-space: normal;
  }
  .actions{
    margin-left: auto;
  }

  .container{
    padding: 14px 12px 22px;
  }
  .card{
    padding: 16px;
    border-radius: 18px;
  }

  .form-row{
    gap: 10px;
  }
  .field{
    flex: 1 1 100%;
    min-width: 0;
  }

  .input,
  select,
  textarea{
    font-size: 14px;
  }

  /* √çcone do calend√°rio: menor e integrado, sem ‚Äúsobrar‚Äù */
  .date-icon-btn{
    width: 40px;
    right: 8px;
  }
  .field.has-icon input{
    padding-right: 52px !important;
  }

  /* Tabela: scroll dentro do card (sem quebrar layout) */
  .tabela-wrapper{
    margin-top: 10px;
    border-radius: 14px;
  }

  footer{
    padding: 12px 12px;
  }
}

/* Loader (igual menu) */
.loader-card{
  width:min(420px, 92vw);
  padding:18px 18px 16px;
  border-radius:18px;
  background: rgba(2,6,23,.66);
  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 30px 80px rgba(0,0,0,.45);
  backdrop-filter: blur(12px);
  text-align:center;
}
.loader-title{ font-weight:700; letter-spacing:.2px; margin:2px 0 6px; }
.loader-sub{ color: rgba(229,231,235,.78); font-size:12px; margin:0 0 10px; }
.spinner{
  width:44px; height:44px;
  border-radius:999px;
  border:4px solid rgba(255,255,255,.14);
  border-top-color: rgba(37,99,235,1);
  border-right-color: rgba(16,185,129,1);
  animation: spin 0.9s linear infinite;
  margin: 0 auto 8px;
}
@keyframes spin{ to{ transform: rotate(360deg);} }

/* Date input with calendar icon */
.date-wrap{ position:relative; }
.date-wrap input[type="date"]{ padding-right:42px !important; }
.date-icn{
  position:absolute; right:10px; top:50%;
  transform: translateY(-50%);
  width:30px; height:30px;
  border-radius:10px;
  display:grid; place-items:center;
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.12);
  cursor:pointer;
  transition: transform .15s ease, background .15s ease, box-shadow .15s ease;
}
.date-icn:hover{
  transform: translateY(-50%) scale(1.03);
  background: rgba(255,255,255,.08);
  box-shadow: 0 12px 28px rgba(0,0,0,.22);
}
.date-icn svg{ width:16px; height:16px; opacity:.92; }



/* --- √çMPAR Premium: logo orb no header --- */
.logo-orb{
      width:36px;height:36px;border-radius:999px;
      position:relative;
      background: conic-gradient(from 210deg,
        #22c55e,
        #06b6d4,
        #3b82f6,
        #a855f7,
        #f97316,
        #22c55e);
      box-shadow:
        0 10px 22px rgba(0,0,0,.35),
        0 0 0 1px rgba(255,255,255,.18) inset;
      overflow:hidden;
      flex:0 0 auto;
    }
    .logo-orb:before{
      content:"";
      position:absolute; inset:-6px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), transparent 55%);
      filter: blur(0.2px);
    }
    .logo-orb:after{
      content:"";
      position:absolute; inset:-14px;
      background: radial-gradient(circle at 50% 50%, rgba(34,197,94,.35), transparent 65%);
      filter: blur(10px);
      opacity:.7;
    }

/* --- Input com √≠cone interno (calend√°rio) --- */
.input-icon-wrap{ position:relative; width:100%; }
.input-icon-wrap input{ padding-right:52px; }
.input-icon-wrap .btn-calendar{
  position:absolute;
  right:10px; top:50%;
  transform:translateY(-50%);
  width:38px; height:38px;
  border-radius:12px;
  display:grid; place-items:center;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.14);
  color: rgba(255,255,255,.92);
  cursor:pointer;
  transition: transform .15s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
}
.input-icon-wrap .btn-calendar:hover{
  transform: translateY(-50%) scale(1.03);
  background: rgba(255,255,255,.09);
  border-color: rgba(255,255,255,.22);
  box-shadow: 0 10px 22px rgba(0,0,0,.25);
}
.input-icon-wrap .btn-calendar:active{ transform: translateY(-50%) scale(.98); }
.input-icon-wrap .btn-calendar svg{ opacity:.95 }

/* Esconde o √≠cone nativo do Chrome pra n√£o duplicar */
input[type="date"]::-webkit-calendar-picker-indicator{ opacity:0; cursor:pointer; }
input[type="date"]::-webkit-inner-spin-button{ display:none; }

/* --- HEADER (ajuste responsivo / igual ao menu) --- */
.header-inner{display:flex;align-items:center;justify-content:space-between;gap:14px;flex-wrap:wrap;}
.brand{display:flex;align-items:center;gap:14px;min-width:0;}
.brand-text{display:flex;flex-direction:column;gap:2px;min-width:0;}
.brand-kicker{letter-spacing:.18em;text-transform:uppercase;font-weight:700;font-size:12px;opacity:.9;}
.brand-title{font-size:22px;font-weight:800;line-height:1.1;}
.brand-sub{font-size:14px;font-weight:700;opacity:.95;line-height:1.2;}
.brand-tagline{font-size:12px;opacity:.85;line-height:1.2;max-width:52ch;}
header{padding:14px 18px;}
@media (max-width: 720px){
  header{padding:14px 14px;}
  .header-inner{justify-content:flex-start;}
  .tag-top{margin-left:auto;}
  .brand-title{font-size:20px;}
}
@media (max-width: 520px){
  .header-inner{flex-direction:column;align-items:flex-start;}
  .tag-top{width:100%;display:flex;justify-content:flex-end;}
  .brand-tagline{max-width:100%;}
}


/* ===== Header layout (stacked like MENU) ===== */
html, body{ overflow-x:hidden; }
header{ padding:14px 14px 12px; }
.header-inner{ display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
.brand{ display:flex; align-items:center; gap:12px; min-width:0; }
.brand-text{ display:flex; flex-direction:column; gap:2px; min-width:0; }
.brand-kicker{ letter-spacing:.24em; font-size:12px; opacity:.9; }
.brand-title{ font-size:18px; font-weight:800; line-height:1.05; }
.brand-sub{ font-size:14px; font-weight:700; opacity:.92; }
.brand-tagline{ font-size:12px; opacity:.75; max-width:60ch; white-space:normal; }
.tag-top{ margin-left:auto; }

@media (max-width: 720px){
  .header-inner{ justify-content:flex-start; }
  .tag-top{ width:100%; margin-left:0; display:flex; justify-content:flex-end; }
  .brand-tagline{ max-width:100%; }
}
800;line-height:1.1;}
.brand-sub{font-size:14px;font-weight:700;opacity:.95;line-height:1.2;}
.brand-tagline{font-size:12px;opacity:.85;line-height:1.2;max-width:52ch;}
header{padding:14px 18px;}
@media (max-width: 720px){
  header{padding:14px 14px;}
  .header-inner{justify-content:flex-start;}
  .tag-top{margin-left:auto;}
  .brand-title{font-size:20px;}
}
@media (max-width: 520px){
  .header-inner{flex-direction:column;align-items:flex-start;}
  .tag-top{width:100%;display:flex;justify-content:flex-end;}
  .brand-tagline{max-width:100%;}
}


/* ===== Header layout (stacked like MENU) ===== */
html, body{ overflow-x:hidden; }
header{ padding:14px 14px 12px; }
.header-inner{ display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
.brand{ display:flex; align-items:center; gap:12px; min-width:0; }
.brand-text{ display:flex; flex-direction:column; gap:2px; min-width:0; }
.brand-kicker{ letter-spacing:.24em; font-size:12px; opacity:.9; }
.brand-title{ font-size:18px; font-weight:800; line-height:1.05; }
.brand-sub{ font-size:14px; font-weight:700; opacity:.92; }
.brand-tagline{ font-size:12px; opacity:.75; max-width:60ch; white-space:normal; }
.tag-top{ margin-left:auto; }

@media (max-width: 720px){
  .header-inner{ justify-content:flex-start; }
  .tag-top{ width:100%; margin-left:0; display:flex; justify-content:flex-end; }
  .brand-tagline{ max-width:100%; }
}

/* Loader (igual menu) ‚Äî overlay (n√£o ocupa espa√ßo) */
#pageLoader{
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 18px;
  background: radial-gradient(1200px 600px at 20% 10%, rgba(59,130,246,.35), transparent 55%),
              radial-gradient(900px 500px at 90% 30%, rgba(16,185,129,.28), transparent 60%),
              linear-gradient(120deg, #031434 0%, #0b2b47 35%, #0f6a66 100%);
  z-index: 9999;
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transition: opacity .35s ease, transform .35s ease, visibility .35s ease;
}
#pageLoader.hidden{
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transform: translateY(-6px);
}

/* Mobile/overflow safety */
html, body{ width:100%; overflow-x:hidden; }

/* =========================================================
   SWEETALERT2 ‚Äî Tema √çMPAR Premium (UI only)
   ========================================================= */
.impar-swal{
  background: rgba(2,6,23,.92) !important;
  color: #e5e7eb !important;
  border: 1px solid rgba(255,255,255,.10) !important;
  border-radius: 18px !important;
  box-shadow: 0 30px 80px rgba(0,0,0,.55) !important;
  backdrop-filter: blur(14px);
}
.impar-swal .swal2-title{ color:#e5e7eb !important; font-weight:800; }
.impar-swal .swal2-html-container{ color: rgba(229,231,235,.88) !important; }
.impar-swal .swal2-icon{ border-color: rgba(59,130,246,.8) !important; }
.impar-swal .swal2-loader{
  border-color: rgba(59,130,246,.25) !important;
  border-top-color: rgba(59,130,246,.95) !important;
}
.impar-swal-confirm{
  border: 0 !important;
  border-radius: 12px !important;
  padding: 10px 14px !important;
  font-weight: 800 !important;
  color: #fff !important;
  background: linear-gradient(120deg,#0b1e4a,#0e3b6e,#0f766e) !important;
  box-shadow: 0 18px 38px rgba(0,0,0,.35) !important;
}
.impar-swal-cancel{
  border: 1px solid rgba(255,255,255,.16) !important;
  border-radius: 12px !important;
  padding: 10px 14px !important;
  font-weight: 800 !important;
  color: #e5e7eb !important;
  background: rgba(255,255,255,.06) !important;
}
.impar-swal .swal2-close{ color: rgba(229,231,235,.7) !important; }
.impar-swal-body{
  display:flex; gap:12px; align-items:center; justify-content:center;
  padding-top: 6px;
}
.impar-spinner{
  width:18px; height:18px; border-radius:999px;
  border:3px solid rgba(59,130,246,.25);
  border-top-color: rgba(59,130,246,.95);
  animation: imparSpin .85s linear infinite;
  flex: 0 0 auto;
}
@keyframes imparSpin { to { transform: rotate(360deg); } }
.impar-swal-sub{ text-align:left; line-height:1.25; }
.impar-swal-sub b{ color:#e5e7eb; }


/* =========================================================
   TRANSI√á√ÉO DE ENTRADA ‚Äî estilo slide (menu ‚Üí solicita√ß√£o)
   ========================================================= */
body { opacity: 0; }
@keyframes imparEnter {
  0% { opacity:0; transform: translateY(34px) scale(.97); filter: blur(10px); }
  100% { opacity:1; transform: translateY(0) scale(1); filter: blur(0); }
}
body.impar-enter { animation: imparEnter .80s cubic-bezier(.16,1,.3,1) both; }
@media (prefers-reduced-motion: reduce) {
  body { opacity: 1; }
  body.impar-enter { animation:none; }
}


/* ===== Loader Premium ‚Äî padr√£o INDEX (override) ===== */
#pageLoader{
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background: rgba(2,6,23,.45);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index: 9999;
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transition: opacity .35s ease, transform .35s ease, visibility .35s ease;
}
#pageLoader.hidden{
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transform: translateY(-6px);
}


/* ===== Bot√µes verdes ‚Äî hover/focus premium (zoom + brilho) ===== */
.btn-primary{
  transition: transform .22s cubic-bezier(.16,1,.3,1),
              box-shadow .22s cubic-bezier(.16,1,.3,1),
              filter .22s cubic-bezier(.16,1,.3,1);
  will-change: transform;
}
.btn-primary:hover{
  transform: translateY(-1px) scale(1.035);
  filter: saturate(1.18) brightness(1.08);
  box-shadow:
    0 0 0 1px rgba(34,197,94,.95),
    0 0 22px rgba(34,197,94,.55),
    0 18px 45px rgba(22,163,74,.55);
}
.btn-primary:active{
  transform: translateY(0) scale(.99);
  filter: saturate(1.08) brightness(1.03);
}
.btn-primary:focus-visible{
  outline:none;
  transform: translateY(-1px) scale(1.035);
  box-shadow:
    0 0 0 2px rgba(2,6,23,.90),
    0 0 0 4px rgba(34,197,94,.75),
    0 0 26px rgba(34,197,94,.55);
}
.pill-btn{
  transition: transform .2s cubic-bezier(.16,1,.3,1), box-shadow .2s cubic-bezier(.16,1,.3,1);
}
.pill-btn:hover{ transform: translateY(-1px) scale(1.02); box-shadow: 0 12px 28px rgba(0,0,0,.28); }
.pill-btn:focus-visible{ outline:none; box-shadow: 0 0 0 2px rgba(2,6,23,.9), 0 0 0 4px rgba(47,123,255,.55); }


  /* ====== Ajustes espec√≠ficos do m√≥dulo Pricing ====== */
  .pricing-wrap {
    width: min(1180px, calc(100vw - 48px));
    margin: 18px auto 28px;
  }
  .pricing-card {
    background: rgba(6, 20, 32, .62);
    border: 1px solid rgba(57, 255, 20, .22);
    border-radius: 22px;
    box-shadow: 0 14px 34px rgba(0,0,0,.35);
    backdrop-filter: blur(10px);
    padding: 22px;
  }
  .pricing-title {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    margin-bottom: 14px;
  }
  .pricing-title h1 {
    margin:0;
    font-size: 22px;
    letter-spacing: .2px;
    display:flex;
    align-items:center;
    gap:10px;
  }
  .pricing-actions {
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap: wrap;
    justify-content: flex-end;
  }
  .pricing-search {
    display:flex;
    gap:10px;
    align-items:center;
    width: 100%;
    margin: 14px 0 12px;
  }
  .pricing-search input {
    flex: 1;
  }
  .table-wrap {
    margin-top: 10px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.08);
    overflow:hidden;
  }
  table {
    width:100%;
    border-collapse: collapse;
    font-size: 14px;
  }
  thead {
    background: rgba(15, 58, 88, .55);
  }
  th, td {
    padding: 12px 12px;
    border-bottom: 1px solid rgba(255,255,255,.06);
    text-align:left;
    vertical-align: middle;
  }
  tbody tr:hover {
    background: rgba(255,255,255,.03);
  }
  .pill {
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.12);
    font-size: 12px;
    color: rgba(255,255,255,.9);
    white-space: nowrap;
  }
  .pill.ok { border-color: rgba(57,255,20,.32); box-shadow: 0 0 18px rgba(57,255,20,.12); }
  .pill.warn { border-color: rgba(255,193,7,.35); box-shadow: 0 0 18px rgba(255,193,7,.10); }
  .pill.err { border-color: rgba(255,64,64,.35); box-shadow: 0 0 18px rgba(255,64,64,.10); }
  .muted {
    opacity: .78;
    font-size: 12px;
  }
  .right {
    text-align:right;
  }
  .link-btn {
    background: transparent;
    border: 1px solid rgba(255,255,255,.14);
    padding: 8px 12px;
    border-radius: 12px;
    cursor: pointer;
    color: rgba(255,255,255,.95);
  }
  .link-btn:hover {
    border-color: rgba(57,255,20,.25);
  }
  /* Modal */
  .modal-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.58);
    display:none;
    align-items:center;
    justify-content:center;
    padding: 18px;
    z-index: 9999;
  }
  .modal {
    width: min(980px, 100%);
    max-height: min(80vh, 720px);
    overflow:auto;
    background: rgba(6, 20, 32, .92);
    border: 1px solid rgba(57,255,20,.22);
    border-radius: 22px;
    box-shadow: 0 20px 60px rgba(0,0,0,.55);
    padding: 18px;
  }
  .modal-head {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-bottom: 10px;
  }
  pre {
    margin: 0;
    padding: 12px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.18);
    overflow:auto;
    font-size: 12px;
    line-height: 1.4;
  }
  .top-row {
    display:flex;
    gap:12px;
    align-items:center;
    flex-wrap: wrap;
  }
  .kpi {
    display:flex;
    gap:10px;
    align-items:baseline;
    padding: 10px 12px;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.03);
  }
  .kpi b { font-size: 18px; }
  </style>
</head>
<body>

<header>
<div class="header-inner">
<div class="brand"><div aria-hidden="true" class="logo-orb"></div><div class="brand-text"><div class="brand-kicker">PLATAFORMA</div><div class="brand-title">ERP √çMPAR</div><div class="brand-sub">Solicita√ß√£o de Materiais</div><div class="brand-tagline">Padroniza√ß√£o do pedido, do canteiro ao suprimentos</div></div></div>
<div class="tag-top">
<button class="pill-btn" id="btnVoltarMenu" type="button">
<span class="icn">üè†</span> Menu principal
      </button>
</div>
</div>
</header>

  <div class="pricing-wrap">
    <div class="pricing-card">
      <div class="pricing-title">
        <h1>üîé Consulta de Pre√ßos ‚Äî ERP √çMPAR</h1>
        <div class="pricing-actions">
          <span class="pill" id="pillConn">API: aguardando‚Ä¶</span>
          <button class="btn btn-secondary" id="btnConfig">Configurar chave</button>
          <button class="btn btn-primary" id="btnRefresh">Atualizar</button>
        </div>
      </div>

      <div class="pricing-search">
        <input class="input" id="q" placeholder="Buscar por obra, c√≥digo ou ID (ex: OBRA_001, 2734, Q-...)" />
<button id=\"btnImportCsv\" class=\"btn btn-green\" type=\"button\">Importar CSV</button>
        <button class="btn btn-primary" id="btnSearch">Buscar</button>
      </div>

      <div class="top-row" style="margin: 6px 0 10px;">
        <div class="kpi"><span class="muted">√öltima atualiza√ß√£o</span> <b id="kpiTime">‚Äî</b></div>
        <div class="kpi"><span class="muted">Registros</span> <b id="kpiCount">‚Äî</b></div>
        <div class="kpi"><span class="muted">Status</span> <b id="kpiStatus">‚Äî</b></div>
      </div>

      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th style="width: 210px;">ID</th>
              <th style="width: 140px;">Obra</th>
              <th style="width: 90px;">Itens</th>
              <th style="width: 140px;" class="right">Total</th>
              <th style="width: 160px;">Status</th>
              <th style="width: 110px;">A√ß√£o</th>
            </tr>
          </thead>
          <tbody id="tbody">
            <tr><td colspan="6" class="muted" style="padding:14px;">Carregando‚Ä¶</td></tr>
          </tbody>
        </table>
      </div>

      <div class="muted" style="margin-top: 10px;">
        Dica: o front (GitHub Pages) conversa com a API (KingHost) ‚Äî se der erro, verifique CORS e a chave X-API-KEY.
      </div>
    </div>
  </div>

  <!-- Modal: Config -->
  <div class="modal-backdrop" id="modalConfig">
    <div class="modal">
      <div class="modal-head">
        <b style="font-size:16px;">üîê Configurar acesso</b>
        <button class="link-btn" id="btnCloseConfig">Fechar</button>
      </div>
      <div class="muted" style="margin-bottom: 10px;">
        A chave fica salva no seu navegador (localStorage). Use a mesma do config.php do servidor (API).
      </div>
      <div class="pricing-search" style="margin: 0 0 12px;">
        <input class="input" id="apiKey" placeholder="Cole aqui sua X-API-KEY (ex: IMP4R_CHAVE_FIXA_TESTE_123)" />
        <button class="btn btn-primary" id="btnSaveKey">Salvar</button>
      </div>
      <div class="muted">
        Endpoint atual: <span id="apiBaseText"></span>
      </div>
    </div>
  </div>

  <!-- Modal: Detalhe -->
  <div class="modal-backdrop" id="modalDetail">
    <div class="modal">
      <div class="modal-head">
        <b style="font-size:16px;">üìÑ Detalhe da cota√ß√£o</b>
        <button class="link-btn" id="btnCloseDetail">Fechar</button>
      </div>
      <pre id="detailPre">Carregando‚Ä¶</pre>
    </div>
  </div>

<script>
(function(){
  // ===== Config =====
  const API_BASE = "https://api.erpimpar.com.br/pricing";
  const KEY_STORAGE = "IMPAR_PRICING_API_KEY";
  const DEFAULT_LIMIT = 50;

  const els = {
    tbody: document.getElementById("tbody"),
    q: document.getElementById("q"),
    pillConn: document.getElementById("pillConn"),
    kpiTime: document.getElementById("kpiTime"),
    kpiCount: document.getElementById("kpiCount"),
    kpiStatus: document.getElementById("kpiStatus"),
    btnRefresh: document.getElementById("btnRefresh"),
    btnSearch: document.getElementById("btnSearch"),
    btnConfig: document.getElementById("btnConfig"),
    modalConfig: document.getElementById("modalConfig"),
    apiKey: document.getElementById("apiKey"),
    apiBaseText: document.getElementById("apiBaseText"),
    btnCloseConfig: document.getElementById("btnCloseConfig"),
    btnSaveKey: document.getElementById("btnSaveKey"),
    modalDetail: document.getElementById("modalDetail"),
    btnCloseDetail: document.getElementById("btnCloseDetail"),
    detailPre: document.getElementById("detailPre"),
  };

  function formatBRL(n) {
    if (n === null || n === undefined || n === "") return "‚Äî";
    const v = Number(n);
    if (!isFinite(v)) return "‚Äî";
    return v.toLocaleString("pt-BR", { style:"currency", currency:"BRL" });
  }

  function pill(kind, text) {
    els.pillConn.classList.remove("ok","warn","err");
    if (kind) els.pillConn.classList.add(kind);
    els.pillConn.textContent = text;
  }

  function openModal(el) { el.style.display = "flex"; }
  function closeModal(el) { el.style.display = "none"; }

  function getKey() {
    return localStorage.getItem(KEY_STORAGE) || "";
  }
  function setKey(v) {
    localStorage.setItem(KEY_STORAGE, v || "");
  }

  function setLoadingRow(msg) {
    els.tbody.innerHTML = `<tr><td colspan="6" class="muted" style="padding:14px;">${msg || "Carregando‚Ä¶"}<\/td><\/tr>`;
  }

  async function apiFetch(path, opts={}) {
    const key = getKey();
    const headers = Object.assign({"Content-Type":"application/json"}, (opts.headers||{}));
    if (key) headers["X-API-KEY"] = key;

    const res = await fetch(API_BASE + path, {
      method: opts.method || "GET",
      headers,
      body: opts.body ? JSON.stringify(opts.body) : undefined
    });

    // tenta JSON sempre
    let data = null;
    const ct = res.headers.get("content-type") || "";
    if (ct.includes("application/json")) {
      data = await res.json().catch(()=>null);
    } else {
      const txt = await res.text().catch(()=> "");
      data = { raw: txt };
    }

    if (!res.ok) {
      const msg = (data && data.error) ? data.error : `http_${res.status}`;
      const e = new Error(msg);
      e.status = res.status;
      e.data = data;
      throw e;
    }
    return data;
  }

  function rowStatusPill(status) {
    const s = String(status||"").toLowerCase();
    if (s.includes("completed") || s.includes("concl") || s.includes("ok")) return `<span class="pill ok">‚úî ${status}<\/span>`;
    if (s.includes("error") || s.includes("falha")) return `<span class="pill err">‚úñ ${status}<\/span>`;
    return `<span class="pill warn">‚è≥ ${status||"‚Äî"}<\/span>`;
  }

  function renderRows(items) {
    if (!items || !items.length) {
      els.tbody.innerHTML = `<tr><td colspan="6" class="muted" style="padding:14px;">Nenhuma cota√ß√£o encontrada.<\/td><\/tr>`;
      return;
    }

    els.tbody.innerHTML = items.map(it => {
      const id = it.quote_id || "‚Äî";
      const obra = it.obra_id || "‚Äî";
      const itens = it.items_count ?? "‚Äî";
      const total = formatBRL(it.total_best);
      const status = it.status || "‚Äî";

      return `
        <tr>
          <td><b>${id}<\/b><div class="muted">${(it.updated_at||it.created_at||"")}<\/div><\/td>
          <td>${obra}<\/td>
          <td>${itens}<\/td>
          <td class="right"><b>${total}<\/b><\/td>
          <td>${rowStatusPill(status)}<\/td>
          <td>
            <button class="link-btn" data-view="${id}">Ver<\/button>
          <\/td>
        <\/tr>
      `;
    }).join("");

    els.tbody.querySelectorAll("[data-view]").forEach(btn => {
      btn.addEventListener("click", () => viewQuote(btn.getAttribute("data-view")));
    });
  }

  async function loadQuotes() {
    setLoadingRow("Carregando‚Ä¶");
    els.kpiStatus.textContent = "Carregando";
    const q = (els.q.value || "").trim();

    try {
      pill("warn", "API: consultando‚Ä¶");
      const data = await apiFetch(`/list_quotes.php?limit=${DEFAULT_LIMIT}&q=${encodeURIComponent(q)}`);
      renderRows(data.data || []);
      els.kpiCount.textContent = String(data.total ?? (data.data||[]).length);
      els.kpiTime.textContent = new Date().toLocaleString("pt-BR");
      els.kpiStatus.textContent = "OK";
      pill("ok", "API: conectado");
    } catch (e) {
      console.error(e);
      const status = e.status || "";
      if (status === 401) {
        pill("err", "API: n√£o autorizado");
        els.kpiStatus.textContent = "N√£o autorizado";
        setLoadingRow("‚ùå N√£o autorizado. Clique em ‚ÄúConfigurar chave‚Äù.");
        openModal(els.modalConfig);
      } else if (String(e.message||"").includes("Failed to fetch")) {
        pill("err", "API: bloqueado");
        els.kpiStatus.textContent = "Falha (CORS?)";
        setLoadingRow("‚ùå Falha ao consultar a API (prov√°vel CORS). Veja o Console (F12).");
      } else {
        pill("err", "API: erro");
        els.kpiStatus.textContent = "Erro";
        setLoadingRow("‚ùå Erro ao consultar a API. Veja o Console (F12).");
      }
    }
  }

  async function viewQuote(quoteId) {
    openModal(els.modalDetail);
    els.detailPre.textContent = "Carregando‚Ä¶";
    try {
      const data = await apiFetch(`/get_quote.php?quote_id=${encodeURIComponent(quoteId)}`);
      els.detailPre.textContent = JSON.stringify(data, null, 2);
    } catch (e) {
      console.error(e);
      els.detailPre.textContent = "Erro ao carregar detalhes: " + (e.message || "erro");
    }
  }

  // ===== Events =====
  els.btnRefresh.addEventListener("click", loadQuotes);
  els.btnSearch.addEventListener("click", loadQuotes);
  els.q.addEventListener("keydown", (ev) => {
    if (ev.key === "Enter") loadQuotes();
  });

  els.btnConfig.addEventListener("click", () => {
    els.apiKey.value = getKey();
    openModal(els.modalConfig);
  });
  els.btnCloseConfig.addEventListener("click", ()=>closeModal(els.modalConfig));
  els.btnSaveKey.addEventListener("click", () => {
    const v = (els.apiKey.value||"").trim();
    setKey(v);
    closeModal(els.modalConfig);
    loadQuotes();
  });
  els.btnCloseDetail.addEventListener("click", ()=>closeModal(els.modalDetail));

  els.apiBaseText.textContent = API_BASE;

  // Init
  if (!getKey()) {
    pill("warn", "API: configure a chave");
  } else {
    pill("warn", "API: pronto");
  }
  loadQuotes();
})();
</script>


  <!-- IMPORT CSV (ERP) -->
  <input id="csvFile" type="file" accept=".csv,text/csv" style="display:none" />
<script>
/* IMPORTA√á√ÉO CSV (ERP √çMPAR) */
console.log('CSV import helpers loaded');

</script>
</body>
</html>
