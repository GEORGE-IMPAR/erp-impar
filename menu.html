<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ERP √çMPAR ‚Äî Menu Principal</title>
<style>
  :root{
    --bg-main:#020617;
    --texto-principal:#f9fafb;
    --texto-suave:#9ca3af;
    --card-borda:#1f2937;
    --card-fundo:rgba(15,23,42,0.96);
    --azul:#1d4ed8;
    --verde:#22c55e;
    --laranja:#f97316;
  }
  *{
    box-sizing:border-box;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  }
  body{
    margin:0;
    min-height:100vh;
    background:
      radial-gradient(circle at top left,#1d293b 0,transparent 55%),
      radial-gradient(circle at 80% 10%,#0f172a 0,transparent 45%),
      radial-gradient(circle at 20% 80%,#1e293b 0,transparent 55%),
      #020617;
    color:var(--texto-principal);
    display:flex;
    flex-direction:column;
  }

  header{
    padding:14px 18px 10px;
    background:rgba(2,6,23,0.94);
    backdrop-filter:blur(18px);
    border-bottom:1px solid rgba(15,23,42,0.9);
  }
  .topbar{
    max-width:1200px;
    margin:0 auto;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    flex-wrap:wrap;
  }
  .brand-wrap{
    display:flex;
    align-items:center;
    gap:12px;
  }
  .logo-ball{
    width:42px;height:42px;border-radius:18px;
    background:
      conic-gradient(from 210deg,
        #22c55e,
        #22c55e,
        #38bdf8,
        #1d4ed8,
        #fb923c,
        #22c55e);
    box-shadow:0 0 0 1px rgba(15,23,42,0.9),0 12px 28px rgba(15,23,42,1);
  }
  .brand{
    display:flex;
    flex-direction:column;
    gap:2px;
    text-shadow:0 2px 6px rgba(0,0,0,.8);
  }
  .brand span:nth-child(1){
    font-size:11px;
    text-transform:uppercase;
    letter-spacing:.22em;
    opacity:.9;
  }
  .brand span:nth-child(2){
    font-size:22px;
    font-weight:800;
  }
  .brand span:nth-child(3){
    font-size:11px;
    opacity:.9;
  }
  .tag-top{
    font-size:11px;
    text-transform:uppercase;
    letter-spacing:.16em;
    padding:6px 12px;
    border-radius:999px;
    border:1px solid rgba(148,163,184,.6);
    color:#e5e7eb;
    background:radial-gradient(circle at 0 0,rgba(37,99,235,.35),transparent 70%);
  }

  .layout{
    flex:1;
    max-width:1200px;
    margin:0 auto;
    padding:18px 18px 0;
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:18px;
  }

  .hero{
    background:radial-gradient(circle at top left,rgba(37,99,235,0.35),transparent 60%);
    background-color:rgba(2,6,23,0.64);
    border:1px solid rgba(148,163,184,0.35);
    border-radius:28px;
    padding:22px;
    box-shadow:0 22px 60px rgba(0,0,0,.45);
  }

  /* ====== LOGIN √öNICO: perfil do usu√°rio no menu ====== */
  .user-card{
    display:flex;
    gap:14px;
    align-items:center;
    padding:14px 16px;
    border-radius:20px;
    background:rgba(2,6,23,.62);
    border:1px solid rgba(148,163,184,.35);
    box-shadow:0 18px 40px rgba(0,0,0,.45);
    margin-bottom:14px;
  }
  .user-foto{
    width:74px;height:74px;
    border-radius:999px;
    object-fit:cover;
    border:2px solid rgba(255,255,255,.22);
    box-shadow:0 10px 26px rgba(0,0,0,.45);
    background:rgba(255,255,255,.05);
  }
  .user-info{display:flex;flex-direction:column;gap:2px;min-width:0}
  .user-nome{font-size:20px;font-weight:900;letter-spacing:.01em}
  .user-cargo{color:var(--texto-suave);font-weight:700}
  .user-tel{color:var(--texto-suave)}
  .user-email{color:#e5e7eb;text-decoration:underline;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  .btn-logout{
    margin-top:8px;
    width:max-content;
    padding:7px 12px;
    border-radius:999px;
    border:1px solid rgba(148,163,184,.35);
    background:rgba(255,255,255,.06);
    color:#e5e7eb;
    cursor:pointer;
  }
  .btn-logout:hover{background:rgba(255,255,255,.10)}
  .card.locked{
    opacity:.38;
    filter:saturate(.6);
    pointer-events:none;
  }
  .card.locked .btn-card{opacity:.7;}
  .lock-badge{
    display:inline-flex;
    align-items:center;
    gap:6px;
    font-size:11px;
    padding:4px 10px;
    border-radius:999px;
    border:1px solid rgba(248,113,113,.35);
    background:rgba(248,113,113,.08);
    color:#fecaca;
    margin-top:10px;
  }

  .hero-title{
    margin:0;
    font-size:38px;
    line-height:1.05;
    font-weight:900;
  }
  .hero-title .accent{
    color:#c7d2fe;
  }
  .hero-subtitle{
    margin:14px 0 16px;
    color:var(--texto-suave);
    font-size:12.5px;
    line-height:1.55;
    max-width:520px;
  }
  .hero-tags{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    margin-top:12px;
  }
  .hero-pill{
    display:flex;
    align-items:center;
    gap:8px;
    padding:8px 12px;
    border-radius:999px;
    border:1px solid rgba(148,163,184,0.35);
    background:rgba(2,6,23,0.55);
    font-size:12px;
    color:#e5e7eb;
  }
  .hero-highlight{
    margin-top:14px;
    border-radius:14px;
    padding:10px 12px;
    border:1px solid rgba(253,224,71,0.55);
    background:rgba(253,224,71,0.08);
    color:#fde68a;
    font-size:11px;
    line-height:1.45;
  }

  .right{
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .right h2{
    margin:2px 0 8px;
    font-size:12px;
    letter-spacing:.18em;
    text-transform:uppercase;
    color:var(--texto-suave);
    text-align:left;
  }

  .grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
  }

  .card{
    background:radial-gradient(circle at top left,rgba(37,99,235,0.35),transparent 60%);
    background-color:rgba(2,6,23,0.64);
    border:1px solid rgba(148,163,184,0.35);
    border-radius:22px;
    padding:14px;
    box-shadow:0 18px 45px rgba(0,0,0,.38);
    display:flex;
    flex-direction:column;
    min-height:170px;
  }
  .card-top{
    display:flex;
    gap:10px;
    align-items:center;
    margin-bottom:10px;
  }
  .badge{
    width:34px;height:34px;border-radius:14px;
    display:flex;align-items:center;justify-content:center;
    background:rgba(34,197,94,.18);
    border:1px solid rgba(34,197,94,.35);
    box-shadow:0 10px 20px rgba(0,0,0,.25);
    font-size:16px;
  }
  .card-titles{
    display:flex;
    flex-direction:column;
    gap:4px;
    min-width:0;
  }
  .card-titles h3{
    margin:0;
    font-size:14px;
    font-weight:900;
  }
  .chip{
    display:inline-flex;
    width:max-content;
    padding:4px 10px;
    border-radius:999px;
    border:1px solid rgba(148,163,184,0.35);
    background:rgba(2,6,23,0.55);
    color:var(--texto-suave);
    font-size:11px;
  }
  .card p{
    margin:0;
    color:var(--texto-suave);
    font-size:12px;
    line-height:1.5;
  }
  .card-actions{
    margin-top:auto;
    display:flex;
    justify-content:flex-end;
    align-items:center;
  }
  .btn-card{
    border:none;
    cursor:pointer;
    padding:10px 14px;
    border-radius:999px;
    color:#fff;
    font-size:11px;
    font-weight:900;
    text-transform:uppercase;
    letter-spacing:.14em;
    background:linear-gradient(120deg,#1d4ed8,#22c55e);
    box-shadow:0 12px 26px rgba(22,163,74,0.35);
  }
  .btn-card .icn{margin-right:6px}

  footer{
    padding:12px 18px 16px;
    font-size:11px;
    color:var(--texto-suave);
  }
  .rodape-inner{
    max-width:1200px;
    margin:0 auto;
    display:flex;
    justify-content:space-between;
    flex-wrap:wrap;
    gap:12px;
  }

  @media (max-width: 980px){
    .layout{grid-template-columns:1fr}
    .grid{grid-template-columns:1fr}
    .hero-title{font-size:34px}
  }
</style>
</head>
<body>

<header>
  <div class="topbar">
    <div class="brand-wrap">
      <div class="logo-ball"></div>
      <div class="brand">
        <span>PLATAFORMA</span>
        <span>ERP √çMPAR</span>
        <span>Gest√£o integrada de obras & contratos</span>
      </div>
    </div>
    <div class="tag-top">MENU PRINCIPAL ‚Ä¢ ESCOLHA UMA FUNCIONALIDADE</div>
  </div>
</header>

<div class="layout">

  <!-- HERO ESQUERDA -->
  <section class="hero" aria-label="Vis√£o geral ERP √çmpar">

      <!-- PERFIL DO USU√ÅRIO (aparece ap√≥s login √∫nico) -->
      <div class="user-card" id="userCard" style="display:none;">
        <img id="userFoto" class="user-foto" alt="Foto do usu√°rio">
        <div class="user-info">
          <div id="userNome" class="user-nome">‚Äî</div>
          <div id="userCargo" class="user-cargo">‚Äî</div>
          <div id="userTel" class="user-tel">‚Äî</div>
          <a id="userEmail" class="user-email" href="#" target="_blank" rel="noopener">‚Äî</a>
          <button class="btn-logout" id="btnLogout" type="button" style="display:none;">Sair</button>
        </div>
      </div>

    <h1 class="hero-title">
      Sua obra,<br/>
      <span class="accent">no controle total.</span>
    </h1>

    <p class="hero-subtitle">
      Centralize materiais, contratos, cronogramas, custos e RDO em um √∫nico lugar.
      Acompanhe a execu√ß√£o em tempo real e gere pain√©is executivos em poucos cliques.
    </p>

    <div class="hero-tags">
      <div class="hero-pill">üì¶ <strong>Solicita√ß√£o de materiais</strong></div>
      <div class="hero-pill">üìÑ <strong>Contratos & OS</strong></div>
      <div class="hero-pill">üìä <strong>Cronograma e farol</strong></div>
      <div class="hero-pill">üí∞ <strong>Dashboard de custos</strong></div>
      <div class="hero-pill">üßæ <strong>RDO conectado ao cronograma</strong></div>
      <div class="hero-pill">‚úÖ <strong>Status para cliente</strong></div>
    </div>

    <div class="hero-highlight">
      <strong>Novo:</strong> fluxo completo de RDO integrado ao cronograma: planejamento ‚Üí execu√ß√£o em campo (WhatsApp)
      ‚Üí valida√ß√£o do coordenador com atualiza√ß√£o autom√°tica da obra.
    </div>

  </section>

  <!-- COLUNA DIREITA -->
  <aside class="right" aria-label="M√≥dulos dispon√≠veis">
    <h2>Escolha um m√≥dulo para acessar:</h2>

    <div class="grid">

      <article class="card">
        <div class="card-top">
          <div class="badge">üì¶</div>
          <div class="card-titles">
            <h3>Solicita√ß√£o de materiais</h3>
            <span class="chip">Fluxo de compras</span>
          </div>
        </div>
        <p>
          Cadastre solicita√ß√µes de materiais por obra, acompanhe o status
          de aprova√ß√£o e organize o consumo em campo com rastreio completo.
        </p>
        <div class="card-actions">
          <button class="btn-card" id="btnMateriais" type="button">
            <span class="icn">‚Ü≥</span> Acessar
          </button>
        </div>
      </article>

      <article class="card">
        <div class="card-top">
          <div class="badge">üìÑ</div>
          <div class="card-titles">
            <h3>Gerador de documentos</h3>
            <span class="chip">Contratos e OS</span>
          </div>
        </div>
        <p>
          Gere contratos e ordens de servi√ßo padronizadas, com hist√≥rico,
          numera√ß√£o autom√°tica e vers√µes prontas para envio ao cliente.
        </p>
        <div class="card-actions">
          <button class="btn-card" id="btnGerador" type="button">
            <span class="icn">‚Ü≥</span> Acessar
          </button>
        </div>
      </article>

      <article class="card">
        <div class="card-top">
          <div class="badge">üìä</div>
          <div class="card-titles">
            <h3>Cronograma de obras</h3>
            <span class="chip">Farol & linha de base</span>
          </div>
        </div>
        <p>
          Visualize o farol de todas as obras, compare planejado x realizado,
          acompanhe atrasos e acesse o cronograma detalhado com Gantt.
        </p>
        <div class="card-actions">
          <button class="btn-card" id="btnCronograma" type="button">
            <span class="icn">‚Ü≥</span> Acessar
          </button>
        </div>
      </article>

      <article class="card">
        <div class="card-top">
          <div class="badge">üí∞</div>
          <div class="card-titles">
            <h3>Dashboard de custos</h3>
            <span class="chip">M√£o de obra & vari√°veis</span>
          </div>
        </div>
        <p>
          Analise custos de m√£o de obra e custos vari√°veis por obra,
          compare obras entre si e identifique rapidamente onde est√° o gasto.
        </p>
        <div class="card-actions">
          <button class="btn-card" id="btnDashCustos" type="button">
            <span class="icn">‚Ü≥</span> Acessar
          </button>
        </div>
      </article>

      <article class="card">
        <div class="card-top">
          <div class="badge">‚úÖ</div>
          <div class="card-titles">
            <h3>Status para cliente</h3>
            <span class="chip">Resumo executivo em 1 slide</span>
          </div>
        </div>
        <p>
          Gere um painel executivo da obra para o cliente, com planejado x realizado,
          atrasos, respons√°veis e coment√°rios, pronto para PDF e WhatsApp.
        </p>
        <div class="card-actions">
          <button class="btn-card" id="btnStatusCliente" type="button">
            <span class="icn">‚Ü≥</span> Acessar
          </button>
        </div>
      </article>

    </div>
  </aside>

</div>

<footer>
  <div class="rodape-inner">
    <span>¬© 2025 ERP √çMPAR. Todos os direitos reservados.</span>
    <span>Ambiente interno ‚Ä¢ Desenvolvido por √çMPAR Sistemas</span>
  </div>
</footer>

<script>
  // ====== LOGIN √öNICO: sess√£o do usu√°rio ======
  const SESSION_KEYS = ["ERPIMPAR_USER", "erp_usuario_logado", "erp_usuario_logado_v2"];
  function getSession(){
    for(const k of SESSION_KEYS){
      const raw = localStorage.getItem(k) || sessionStorage.getItem(k);
      if(raw){
        try { return { key:k, data: JSON.parse(raw) }; } catch(e){ }
      }
    }
    return null;
  }
  function clearSession(){
    for(const k of SESSION_KEYS){
      localStorage.removeItem(k);
      sessionStorage.removeItem(k);
    }
  }

  const sess = getSession();
  if(!sess || !sess.data){
    window.location.href = "index.html";
  } else {
    const user = sess.data;

    // ====== Preenche cart√£o do usu√°rio ======
    const card = document.getElementById("userCard");
    const foto = document.getElementById("userFoto");
    const nome = document.getElementById("userNome");
    const cargo = document.getElementById("userCargo");
    const tel  = document.getElementById("userTel");
    const email = document.getElementById("userEmail");
    const btnLogout = document.getElementById("btnLogout");

    if(card){
      card.style.display = "flex";
      if(nome) nome.textContent = user.nome || "";
      if(cargo) cargo.textContent = user.cargo || "";
      if(tel) tel.textContent = user.telefone || "";
      if(email){
        email.textContent = user.email || "";
        email.href = user.email ? ("mailto:" + user.email) : "#";
      }
      if(foto){
        const f = user.foto || "";
        foto.src = f;
        foto.style.display = f ? "block" : "none";
      }
      if(btnLogout){
        btnLogout.style.display = "inline-flex";
        btnLogout.addEventListener("click", () => {
          clearSession();
          window.location.href = "index.html";
        });
      }
    }

    // ====== Permiss√µes por m√≥dulo ======
    const allow = new Set((user.modulos || []).map(m => String(m).toLowerCase()));
    const modules = [
      { mod:"materiais", btn:"btnMateriais" },
      { mod:"documentos", btn:"btnGerador" },
      { mod:"cronograma", btn:"btnCronograma" },
      { mod:"dashboard", btn:"btnDashCustos" },
      { mod:"status", btn:"btnStatusCliente" },
    ];

    modules.forEach(({mod, btn}) => {
      const el = document.getElementById(btn);
      if(!el) return;
      const ok = allow.size === 0 ? true : allow.has(mod);
      const article = el.closest("article.card") || el.closest(".card");
      if(!ok && article){
        article.classList.add("locked");
        const actions = article.querySelector(".card-actions") || article;
        if(actions && !article.querySelector(".lock-badge")){
          const b = document.createElement("div");
          b.className = "lock-badge";
          b.textContent = "üîí Sem permiss√£o";
          actions.appendChild(b);
        }
      }
    });

    // ====== Navega√ß√£o (mant√©m suas rotas atuais por enquanto) ======
    document.getElementById('btnMateriais')?.addEventListener('click', () => {
      window.location.href = 'login.html';
    });
    document.getElementById('btnGerador')?.addEventListener('click', () => {
      window.location.href = 'login_doc.html';
    });
    document.getElementById('btnCronograma')?.addEventListener('click', () => {
      window.location.href = 'login_cronograma.html';
    });
    document.getElementById('btnStatusCliente')?.addEventListener('click', () => {
      window.location.href = 'login_status.html';
    });
    document.getElementById('btnDashCustos')?.addEventListener('click', () => {
      window.location.href = 'login_custos.html';
    });
  }
</script>

</body>
</html>
