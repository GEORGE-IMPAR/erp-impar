<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ERP √çMPAR ‚Äî Gest√£o √† Vista TV</title>
  <style>
    :root{
      --bg1:#0b1e4a;
      --bg2:#0e3b6e;
      --bg3:#0f766e;
      --text: #e5e7eb;
      --green:#22c55e;
      --yellow:#facc15;
      --red:#ef4444;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;overflow:hidden}
    body{
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      color:var(--text);
      background:linear-gradient(120deg,var(--bg1),var(--bg2),var(--bg3));
      display:flex;
      flex-direction:column;
    }

    header{
      padding:20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:rgba(2,6,23,.8);
      border-bottom:2px solid rgba(34,197,94,.3);
    }
    .brand{
      display:flex;
      align-items:center;
      gap:14px;
    }
    .logo-orb{
      width:48px;height:48px;border-radius:999px;
      position:relative;
      background: conic-gradient(from 210deg,#22c55e,#06b6d4,#3b82f6,#a855f7,#f97316,#22c55e);
      box-shadow:0 10px 22px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.18) inset;
      overflow:hidden;
    }
    .logo-orb:before{
      content:""; position:absolute; inset:-6px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), transparent 55%);
    }
    .brand-text{display:flex; flex-direction:column; gap:2px;}
    .brand-kicker{font-size:14px; letter-spacing:.22em; text-transform:uppercase; font-weight:800; opacity:.9;}
    .brand-title{font-size:28px; font-weight:900; line-height:1;}
    .brand-sub{font-size:18px; font-weight:800; opacity:.92;}

    .header-info{
      text-align:right;
      font-size:14px;
    }
    .header-info strong{
      display:block;
      font-size:18px;
      color:var(--green);
      margin-bottom:4px;
    }
    .relogio{
      font-size:32px;
      font-weight:900;
      font-variant-numeric:tabular-nums;
    }

    main{
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px;
      position:relative;
    }

    .projeto-card{
      width:100%;
      max-width:900px;
      padding:40px;
      border-radius:24px;
      border:2px solid rgba(148,163,184,.5);
      background:rgba(2,6,23,.85);
      box-shadow:0 30px 80px rgba(0,0,0,.6);
      position:relative;
      opacity:0;
      transform:scale(0.95);
      animation:fadeIn 0.6s ease-out forwards;
    }

    @keyframes fadeIn{
      to{opacity:1; transform:scale(1);}
    }

    .projeto-header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:20px;
      margin-bottom:30px;
    }
    .projeto-titulo{
      font-size:42px;
      font-weight:900;
      line-height:1.1;
      color:#fff;
      text-shadow:0 2px 8px rgba(0,0,0,.5);
    }
    .farol-badge{
      width:80px;
      height:80px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:48px;
      animation:pulse 2s ease-in-out infinite;
      flex-shrink:0;
    }
    .farol-badge.verde{
      background:radial-gradient(circle, rgba(34,197,94,.3), transparent);
      box-shadow:0 0 40px rgba(34,197,94,.6);
    }
    .farol-badge.amarelo{
      background:radial-gradient(circle, rgba(250,204,21,.3), transparent);
      box-shadow:0 0 40px rgba(250,204,21,.6);
    }
    .farol-badge.vermelho{
      background:radial-gradient(circle, rgba(239,68,68,.3), transparent);
      box-shadow:0 0 40px rgba(239,68,68,.6);
    }

    @keyframes pulse{
      0%, 100%{transform:scale(1); opacity:1;}
      50%{transform:scale(1.05); opacity:.85;}
    }

    .projeto-info{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:20px;
      margin-bottom:30px;
    }
    .info-item{
      padding:16px 20px;
      border-radius:12px;
      background:rgba(15,23,42,.6);
      border:1px solid rgba(148,163,184,.3);
    }
    .info-label{
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.1em;
      opacity:.7;
      margin-bottom:6px;
    }
    .info-value{
      font-size:20px;
      font-weight:700;
    }

    .projeto-status{
      padding:24px;
      border-radius:14px;
      background:linear-gradient(135deg, rgba(2,6,23,.7), rgba(15,118,110,.15));
      border:1px solid rgba(34,197,94,.3);
      margin-bottom:30px;
    }
    .status-label{
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.1em;
      color:var(--green);
      margin-bottom:10px;
      font-weight:800;
    }
    .status-text{
      font-size:22px;
      line-height:1.5;
      color:#fff;
    }

    .projeto-footer{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding-top:20px;
      border-top:1px solid rgba(148,163,184,.2);
      font-size:13px;
      opacity:.8;
    }
    .ultima-atualizacao{
      display:flex;
      align-items:center;
      gap:8px;
    }

    .indicador-progresso{
      position:absolute;
      bottom:20px;
      right:20px;
      display:flex;
      gap:6px;
    }
    .dot{
      width:8px;
      height:8px;
      border-radius:999px;
      background:rgba(148,163,184,.3);
      transition:all .3s;
    }
    .dot.active{
      background:var(--green);
      box-shadow:0 0 10px var(--green);
    }

    footer{
      padding:12px;
      text-align:center;
      font-size:12px;
      opacity:.6;
      background:rgba(2,6,23,.5);
    }
  </style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo-orb"></div>
    <div class="brand-text">
      <div class="brand-kicker">ERP</div>
      <div class="brand-title">√çMPAR</div>
      <div class="brand-sub">Gest√£o √† Vista</div>
    </div>
  </div>
  <div class="header-info">
    <strong id="dataAtual">‚Äî</strong>
    <div class="relogio" id="relogio">00:00:00</div>
  </div>
</header>

<main>
  <div id="carrossel">
    <!-- Os cards dos projetos ser√£o inseridos aqui -->
  </div>
</main>

<footer>
  ERP √çMPAR ¬© 2026 ‚Äî Atualiza√ß√£o autom√°tica a cada 10 segundos
</footer>

<script>
const API_BASE = 'https://api.erpimpar.com.br/tv';
let projetos = [];
let indiceAtual = 0;
let intervalCarrossel;

// Inicializar
window.addEventListener('DOMContentLoaded', () => {
  atualizarRelogio();
  setInterval(atualizarRelogio, 1000);
  carregarProjetos();
  setInterval(carregarProjetos, 10000); // Atualiza a cada 10s
});

// Rel√≥gio
function atualizarRelogio() {
  const agora = new Date();
  const data = agora.toLocaleDateString('pt-BR', {weekday:'long', year:'numeric', month:'long', day:'numeric'});
  const hora = agora.toLocaleTimeString('pt-BR');
  
  document.getElementById('dataAtual').textContent = data.charAt(0).toUpperCase() + data.slice(1);
  document.getElementById('relogio').textContent = hora;
}

// Carregar projetos da API
async function carregarProjetos() {
  try {
    const response = await fetch(`${API_BASE}/listar.php`);
    const data = await response.json();
    
    if (data.success && data.projetos && data.projetos.length > 0) {
      projetos = data.projetos;
      
      if (!intervalCarrossel) {
        iniciarCarrossel();
      }
    }
  } catch (error) {
    console.error('Erro ao carregar projetos:', error);
  }
}

// Iniciar carrossel
function iniciarCarrossel() {
  mostrarProjeto(0);
  
  intervalCarrossel = setInterval(() => {
    indiceAtual = (indiceAtual + 1) % projetos.length;
    mostrarProjeto(indiceAtual);
  }, 8000); // 8 segundos por projeto
}

// Mostrar projeto
function mostrarProjeto(indice) {
  const projeto = projetos[indice];
  
  const farolEmoji = {
    'verde': 'üü¢',
    'amarelo': 'üü°',
    'vermelho': 'üî¥'
  };
  
  const dataAtualizada = new Date(projeto.data_atualizacao);
  const dataFormatada = dataAtualizada.toLocaleString('pt-BR');
  
  const html = `
    <div class="projeto-card" style="animation:fadeIn 0.6s ease-out;">
      <div class="projeto-header">
        <h1 class="projeto-titulo">${projeto.nome}</h1>
        <div class="farol-badge ${projeto.farol}">
          ${farolEmoji[projeto.farol] || '‚ö™'}
        </div>
      </div>
      
      <div class="projeto-info">
        <div class="info-item">
          <div class="info-label">üë∑ Coordenador</div>
          <div class="info-value">${projeto.coordenador}</div>
        </div>
        <div class="info-item">
          <div class="info-label">üîß Execu√ß√£o</div>
          <div class="info-value">${projeto.execucao}</div>
        </div>
      </div>
      
      <div class="projeto-status">
        <div class="status-label">üìä Status Atual</div>
        <div class="status-text">${projeto.status}</div>
      </div>
      
      <div class="projeto-footer">
        <div class="ultima-atualizacao">
          <span>üïê</span>
          <span>√öltima atualiza√ß√£o: ${dataFormatada}</span>
        </div>
        <div>
          <strong>${projeto.usuario_atualizacao || 'Sistema'}</strong>
        </div>
      </div>
      
      <div class="indicador-progresso">
        ${projetos.map((_, i) => `<div class="dot ${i === indice ? 'active' : ''}"></div>`).join('')}
      </div>
    </div>
  `;
  
  const carrossel = document.getElementById('carrossel');
  carrossel.innerHTML = html;
}
</script>

</body>
</html>
